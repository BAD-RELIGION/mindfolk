<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="description" content="Mindfolk NFT Gallery - Browse and explore NFTs from your Mindfolk collection" />
    <meta name="author" content="NFT Gallery" />
    <meta name="theme-color" content="#ffc107" />
    <title>Mindfolk Collection Gallery</title>

    <link rel="icon" type="image/png" href="img/mf_dc_icon.png" />
    <link rel="shortcut icon" type="image/png" href="img/mf_dc_icon.png" />

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdb-ui-kit@9.1.0/css/mdb.min.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/gallery.css" />
    <link rel="stylesheet" href="fonts/stylesheet.css" />
  </head>

  <body class="theme-modern">
    <header>
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg fixed-top navbar-scroll" data-mdb-navbar-init>
        <div class="container">
          <a class="navbar-brand mf-logo" href="index.html">
            <img id="nav-logo" src="img/mfblack.png" alt="Logo" onerror="this.style.display='none'; this.parentElement.innerHTML='NFT Gallery';" />
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-mdb-collapse-init
            data-mdb-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <!-- Theme Switcher - Centered -->
            <div class="navbar-nav mx-auto d-flex align-items-center">
              <span class="theme-label me-2" style="font-weight: 500;">THEME</span>
              <div class="theme-switcher btn-group" role="group">
                <button id="themeModern" class="btn btn-sm btn-outline-warning theme-btn active" data-theme="modern">
                  <i class="fas fa-palette"></i> Modern
                </button>
                <button id="themeClassic" class="btn btn-sm btn-outline-warning theme-btn" data-theme="classic">
                  <i class="fas fa-paint-brush"></i> Classic
                </button>
              </div>
            </div>
            <!-- End Theme Switcher -->
            <ul class="navbar-nav d-flex flex-row align-items-center">
              <li class="nav-item me-2" id="walletIndicator" style="display: none;">
                <div class="wallet-indicator d-flex align-items-center gap-2">
                  <img id="walletIndicatorIcon" src="" alt="Wallet" style="height:24px;width:24px;border-radius:6px;" loading="lazy" />
                  <div class="wallet-indicator-info d-flex flex-column">
                    <span class="wallet-indicator-name" id="walletIndicatorName" style="font-size:0.75rem;font-weight:600;line-height:1.2;"></span>
                    <span class="wallet-indicator-balance" id="walletIndicatorBalance" style="font-size:0.7rem;opacity:0.8;line-height:1.2;"></span>
                  </div>
                </div>
              </li>
              <li class="nav-item">
                <button id="connectWalletBtn" class="btn btn-warning btn-sm" data-connect-wallet>
                  <i class="fas fa-wallet"></i> Connect Wallet
                </button>
                <button id="disconnectWalletBtn" class="btn btn-outline-light btn-sm d-none" data-disconnect-wallet>
                  Disconnect
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- Navbar -->

      <!--Section: Hero-->
      <section id="top" class="intro text-center">
        <div class="mask">
          <div class="d-flex justify-content-center align-items-start pt-5">
              <div class="text-white container">
              <h1 id="mainTitle" class="hipeless mb-2" style="font-size: 4rem;">MY MINDFOLK</h1>
              <div class="mt-2">
                <button id="connectWalletBtnHero" class="btn btn-warning btn-sm" data-connect-wallet style="font-size: 0.9rem; padding: 0.5rem 1.5rem;">
                  <i class="fas fa-wallet"></i> Connect Wallet
                </button>
              </div>
              <!-- Token Balance Display -->
              <div id="tokenBalanceDisplay" class="token-balance-display mt-3" style="display: none;">
                <div class="card bg-dark border-warning" style="background: rgba(0,0,0,0.7) !important; border: 2px solid #ffc107; border-radius: 0.75rem; padding: 1rem 1.5rem; display: inline-block; margin: 0 auto; box-shadow: 0 10px 30px rgba(255, 193, 7, 0.3);">
                  <div class="card-body text-center" style="padding: 0;">
                    <div class="token-amount d-flex align-items-center justify-content-center gap-2" style="font-size: 1.5rem; font-weight: bold; color: #ffc107; margin: 0; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">
                      <div id="woodLogoContainer" style="width: 40px; height: 40px; border-radius: 50%; background: #000; display: flex; align-items: center; justify-content: center; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.5); flex-shrink: 0;">
                        <img id="woodTokenIconLarge" src="img/wood-token.png" alt="$WOOD" style="width: 100%; height: 100%; object-fit: contain; display: block;" onerror="this.onerror=null; this.src='img/mfcircle.png'; console.warn('Wood logo (wood-token.png) not found, using fallback');" onload="console.log('✓ Wood logo loaded successfully');" />
                      </div>
                      <span id="tokenBalanceAmount">0.00</span>
                      <span class="text-white" style="font-size: 1rem; margin-left: 0.5rem;">$WOOD</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Wallet NFTs Display - My Gallery (moved to hero section) -->
              <div id="walletNFTsDisplay" class="wallet-nfts-display mt-5" style="display: none;">
                <div id="walletGalleryHeader" class="text-center mb-4">
                  <div class="gallery-stats mb-4">
                    <span class="badge bg-warning text-dark me-2" id="walletNFTsCount">You have 0 Mindfolk NFTs</span>
                  </div>
                </div>
                <div id="walletNFTsGrid" class="row g-4 text-start">
                  <!-- Wallet NFTs will be loaded here -->
                </div>
              </div>
              
            </div>
          </div>
        </div>
      </section>
      <!--Section: Hero-->
    </header>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="loading-indicator" style="display: none;">
      <div class="spinner-border text-warning" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="text-white mt-3">Loading NFTs...</p>
    </div>

    <!-- Gallery Section -->
    <section id="gallery" class="pt-3 pb-5">
      <div class="container mt-3 mb-5">
        <!-- Main Gallery - Collection NFTs (internal reference) -->
        <div id="galleryHeader" class="mb-5" style="display: none;">
          <h1 class="fw-bold mb-3 text-warning gallery-title text-center">Mindfolk Collection</h1>
          <div class="gallery-header-controls d-flex justify-content-between align-items-center mb-4">
            <div class="gallery-stats">
              <span class="badge bg-warning text-dark me-2" id="totalCount">0 NFTs</span>
              <span class="badge bg-secondary me-2" id="loadedCount">0 Loaded</span>
            </div>
            <!-- Gallery View Switcher (Main Gallery Only) -->
            <div class="gallery-view-switcher d-flex align-items-center gap-2">
              <span class="text-white me-2">View:</span>
              <button id="view6Col" class="btn btn-sm btn-outline-warning gallery-view-btn active" data-view="6col" title="6 Columns">
                <i class="fas fa-th-large"></i> 6 Col
              </button>
              <button id="view12Col" class="btn btn-sm btn-outline-warning gallery-view-btn" data-view="12col" title="12 Columns">
                <i class="fas fa-th"></i> 12 Col
              </button>
              <button id="viewList" class="btn btn-sm btn-outline-warning gallery-view-btn" data-view="list" title="List View">
                <i class="fas fa-list"></i> List
              </button>
            </div>
          </div>
        </div>
        
        <div id="galleryGrid" class="row g-4 text-start">
          <!-- NFTs will be loaded here -->
        </div>

        <div id="loadMoreContainer" class="text-center mt-5" style="display: none;">
          <button id="loadMoreBtn" class="btn btn-warning btn-sm me-3" style="font-size: 0.85rem; padding: 0.4rem 1rem;">
            <i class="fas fa-plus"></i> Load More NFTs
          </button>
          <button id="loadAllBtn" class="btn btn-warning btn-sm" style="font-size: 0.85rem; padding: 0.4rem 1rem;">
            <i class="fas fa-list"></i> Load All NFTs
          </button>
        </div>

        <div id="emptyState" class="text-center py-5">
          <i class="fas fa-images fa-3x text-muted mb-3"></i>
          <p class="text-muted">Loading collection NFTs...</p>
        </div>
      </div>
    </section>

    <!-- NFT Modal -->
    <div class="modal fade" id="nftModal" tabindex="-1" aria-labelledby="nftModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-dark text-white">
          <div class="modal-header border-secondary">
            <h5 class="modal-title" id="nftModalLabel">NFT Details</h5>
            <button type="button" class="btn-close btn-close-white" data-mdb-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="nftModalContent">
              <!-- NFT details will be loaded here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-white text-center text-lg-start footer-dark py-5">
      <div class="container my-5">
        <div class="text-center">
          <p class="mb-0">NFT Gallery © 2025</p>
        </div>
      </div>
    </footer>

    <!-- Wallet Selection Modal -->
    <div class="wallet-modal" id="walletModal" tabindex="-1" aria-labelledby="walletModalLabel" aria-hidden="true">
      <div class="wallet-modal-dialog">
        <div class="wallet-modal-content">
          <div class="wallet-modal-header">
            <h5 class="wallet-modal-title" id="walletModalLabel">Connect a wallet</h5>
            <button type="button" class="wallet-modal-close" data-mdb-dismiss="modal" aria-label="Close">
              <i class="fa-solid fa-times"></i>
            </button>
          </div>
          <div class="wallet-modal-body">
            <p class="wallet-modal-subtitle">Select a wallet to connect</p>
            <div class="wallet-grid" id="walletGrid">
              <!-- Wallet options will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="wallet-modal-backdrop" id="walletModalBackdrop"></div>

    <script src="https://cdn.jsdelivr.net/npm/mdb-ui-kit@9.1.0/js/mdb.min.js"></script>
    <script id="solana-web3-script" src="https://unpkg.com/@solana/web3.js@1.95.1/lib/index.iife.min.js"></script>
    <!-- Load gallery.js first to define CONFIG (made globally available), then wallet.js can access it -->
    <script src="js/gallery.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/theme-switcher.js"></script>
    <script>
      // Navbar scroll behavior
      (function () {
        const nav = document.querySelector('.navbar');
        const logo = document.getElementById('nav-logo');

        function swapLogo(newSrc) {
          if (!logo) return;
          if (logo.src.includes(newSrc)) return;
          logo.classList.add("fading");
          setTimeout(() => {
            logo.src = newSrc;
            logo.classList.remove("fading");
          }, 200);
        }

        function onScroll() {
          if (window.scrollY > 10) {
            nav.classList.add("navbar-scrolled");
            if (logo) swapLogo("img/mfblack.png");
          } else {
            nav.classList.remove("navbar-scrolled");
            if (logo) swapLogo("img/mfblack.png");
          }
        }

        onScroll();
        window.addEventListener("scroll", onScroll, { passive: true });
      })();

      // Smooth scroll for nav links
      document.querySelectorAll('.navbar a.nav-link[href^="#"]').forEach(a => {
        a.addEventListener('click', (e) => {
          const href = a.getAttribute('href');
          if (href === '#') return;
          const id = href.slice(1);
          const el = document.getElementById(id);
          if (!el) return;
          e.preventDefault();
          const y = el.getBoundingClientRect().top + window.pageYOffset - 100;
          window.scrollTo({ top: y, behavior: 'smooth' });
          
          // Close mobile menu
          const navEl = document.getElementById('navbarSupportedContent');
          if (navEl && navEl.classList.contains('show')) {
            try {
              if (window.mdb?.Collapse) new mdb.Collapse(navEl).hide();
              else navEl.classList.remove('show');
            } catch (_) { navEl.classList.remove('show'); }
          }
        });
      });
    </script>
  </body>
</html>

